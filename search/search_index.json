{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Home \u00b6 The SA-SentinelOneDevices add-on allows Splunk Enterprise Security admins to use SentinelOne device data with the Asset Database. Example Output This Supporting add-on is only intended to work with Splunk Enterprise Security deployments. Disclaimer This Splunk Supporting Add-on is not affiliated with SentinelOne, Inc. and is not sponsored or sanctioned by the SentinelOne team. As such, the included documentation does not contain information on how to get started with SentinelOne. Rather, this documentation serves as a guide to use SentinelOne device data with Splunk Enterprise Security. Please visit https://www.sentinelone.com/ for more information about SentinelOne. Assumptions \u00b6 This documentation assumes the following: You have a working Splunk Enterprise Security environment. This add-on is not intended to work without Splunk ES. You already have SentinelOne device data ingested using the SentinelOne App For Splunk . Familiarity with setting up a new Asset source in Enterprise Security. About \u00b6 Info Description SA-SentinelOneDevices 1.0.1 - Splunkbase | GitHub Splunk Enterprise Security Version (Required) 7.x | 6.x SentinelOne App For Splunk (Required) 5.1.x Quick Start","title":"Home"},{"location":"#home","text":"The SA-SentinelOneDevices add-on allows Splunk Enterprise Security admins to use SentinelOne device data with the Asset Database. Example Output This Supporting add-on is only intended to work with Splunk Enterprise Security deployments. Disclaimer This Splunk Supporting Add-on is not affiliated with SentinelOne, Inc. and is not sponsored or sanctioned by the SentinelOne team. As such, the included documentation does not contain information on how to get started with SentinelOne. Rather, this documentation serves as a guide to use SentinelOne device data with Splunk Enterprise Security. Please visit https://www.sentinelone.com/ for more information about SentinelOne.","title":"Home"},{"location":"#assumptions","text":"This documentation assumes the following: You have a working Splunk Enterprise Security environment. This add-on is not intended to work without Splunk ES. You already have SentinelOne device data ingested using the SentinelOne App For Splunk . Familiarity with setting up a new Asset source in Enterprise Security.","title":"Assumptions"},{"location":"#about","text":"Info Description SA-SentinelOneDevices 1.0.1 - Splunkbase | GitHub Splunk Enterprise Security Version (Required) 7.x | 6.x SentinelOne App For Splunk (Required) 5.1.x Quick Start","title":"About"},{"location":"configure/","text":"Configure \u00b6 Each field can be customized to fit your environment. The following fields should be examined and tailored to your data. It is recommended to clone the default search before making changes (see Clone Saved Search ). Update Priority Update Category Update Business Unit Update Schedule Update Cleanup","title":"Configure"},{"location":"configure/#configure","text":"Each field can be customized to fit your environment. The following fields should be examined and tailored to your data. It is recommended to clone the default search before making changes (see Clone Saved Search ). Update Priority Update Category Update Business Unit Update Schedule Update Cleanup","title":"Configure"},{"location":"configure/bunit/","text":"Business Unit Field (bunit) \u00b6 To update the bunit field modify the SentinelOne Devices Lookup - Gen saved search. It is recommended to clone the default search before making changes (see Clone Saved Search ). The bunit field uses standard fields from SentinelOne data. Most will find that the default configuration for this field will work for their needs. See Asset Mappings for description of the default fields used.","title":"Update Business Unit"},{"location":"configure/bunit/#business-unit-field-bunit","text":"To update the bunit field modify the SentinelOne Devices Lookup - Gen saved search. It is recommended to clone the default search before making changes (see Clone Saved Search ). The bunit field uses standard fields from SentinelOne data. Most will find that the default configuration for this field will work for their needs. See Asset Mappings for description of the default fields used.","title":"Business Unit Field (bunit)"},{"location":"configure/category/","text":"Category Field \u00b6 Important Increase the default category field value limit to see all fields available. See How to update multivalue field limit under the Quickstart guide . To update the category field modify the SentinelOne Devices Lookup - Gen saved search. It is recommended to clone the default search before making changes (see Clone Saved Search ). The category field by default includes many important fields. Most will find that the default configuration for this field will work for their needs. This field is an eval statement with multiple functions to map and clean field values. See the Category Field reference for full field mappings and example values.","title":"Update Category"},{"location":"configure/category/#category-field","text":"Important Increase the default category field value limit to see all fields available. See How to update multivalue field limit under the Quickstart guide . To update the category field modify the SentinelOne Devices Lookup - Gen saved search. It is recommended to clone the default search before making changes (see Clone Saved Search ). The category field by default includes many important fields. Most will find that the default configuration for this field will work for their needs. This field is an eval statement with multiple functions to map and clean field values. See the Category Field reference for full field mappings and example values.","title":"Category Field"},{"location":"configure/cleanup/","text":"Update Cleanup \u00b6 The saved search SentinelOne Devices Lookup - Cleanup runs every hour 39 minutes after the hour to remove old/stale device data from the Splunk KVstore . By default, it will remove any device that has not reported in longer than 2 days. Note Even though a device may be removed, it will be re-added by the saved search SentinelOne Devices Lookup - Gen if it begins to send data again. Update Search Macro \u00b6 To change the retention period from the default 2 days, there is a search macro that will need to be updated. Navigate to Settings > Advanced Search > Search Macros. Set the \"App\" to SA-SentinelOneDeviecs . Set the \"Owner\" to Any . Click on sa_sentinelone_retention to modify the definition. Set the definition to a valid time modifier . Important Make sure to keep the quotes around the definition. i.e. \"-7d@d\" Update Search Schedule \u00b6 It may also be necessary to update how often the cleanup search runs (default: hourly). To update the default schedule perform the following steps: Navigate to Settings > Searches, reports, and alerts. Set the \"App\" dropdown to SA-SentinelOneDevices . Set the \"Owner\" dropdown to All . Click \"Edit\" under actions for the search SentinelOne Devices Lookup - Cleanup Click \"Edit Schedule\" and update the schedule and necessary.","title":"Update Cleanup"},{"location":"configure/cleanup/#update-cleanup","text":"The saved search SentinelOne Devices Lookup - Cleanup runs every hour 39 minutes after the hour to remove old/stale device data from the Splunk KVstore . By default, it will remove any device that has not reported in longer than 2 days. Note Even though a device may be removed, it will be re-added by the saved search SentinelOne Devices Lookup - Gen if it begins to send data again.","title":"Update Cleanup"},{"location":"configure/cleanup/#update-search-macro","text":"To change the retention period from the default 2 days, there is a search macro that will need to be updated. Navigate to Settings > Advanced Search > Search Macros. Set the \"App\" to SA-SentinelOneDeviecs . Set the \"Owner\" to Any . Click on sa_sentinelone_retention to modify the definition. Set the definition to a valid time modifier . Important Make sure to keep the quotes around the definition. i.e. \"-7d@d\"","title":"Update Search Macro"},{"location":"configure/cleanup/#update-search-schedule","text":"It may also be necessary to update how often the cleanup search runs (default: hourly). To update the default schedule perform the following steps: Navigate to Settings > Searches, reports, and alerts. Set the \"App\" dropdown to SA-SentinelOneDevices . Set the \"Owner\" dropdown to All . Click \"Edit\" under actions for the search SentinelOne Devices Lookup - Cleanup Click \"Edit Schedule\" and update the schedule and necessary.","title":"Update Search Schedule"},{"location":"configure/priority/","text":"Priority Field \u00b6 To update the priority field modify the SentinelOne Devices Lookup - Gen saved search. It is recommended to clone the default search before making changes (see Clone Saved Search ). The priority field is very generic by default and should be updated to suite your environment. The following table describes how this field is set. Type Condition Severity Description RegEx* domain_controller critical All domain controllers RegEx* server|ubuntu|rhel|linux high Servers boolean true() medium catch-all. Remaining devices receive medium severity. *Regex Match is performed on the category field. Default priority field definition priority = case ( match ( category , \"domain_controller\" ), \"critical\" , match ( category , \"server|ubuntu|rhel|linux\" ), \"high\" , true (), \"medium\" )","title":"Update Priority"},{"location":"configure/priority/#priority-field","text":"To update the priority field modify the SentinelOne Devices Lookup - Gen saved search. It is recommended to clone the default search before making changes (see Clone Saved Search ). The priority field is very generic by default and should be updated to suite your environment. The following table describes how this field is set. Type Condition Severity Description RegEx* domain_controller critical All domain controllers RegEx* server|ubuntu|rhel|linux high Servers boolean true() medium catch-all. Remaining devices receive medium severity. *Regex Match is performed on the category field. Default priority field definition priority = case ( match ( category , \"domain_controller\" ), \"critical\" , match ( category , \"server|ubuntu|rhel|linux\" ), \"high\" , true (), \"medium\" )","title":"Priority Field"},{"location":"configure/schedule/","text":"Update Schedule \u00b6 To update the schedule modify the SentinelOne Devices Lookup - Gen saved search. It is recommended to clone the default search before making changes (see Clone Saved Search ). The default saved search runs on the 29th minute of every hour to update and continually build the SentinelOne assets. Most users will find that this schedule works for their environment. To update the default schedule perform the following steps: Navigate to Settings > Searches, reports, and alerts. Set the \"App\" dropdown to SA-SentinelOneDevices . Set the \"Owner\" dropdown to All . Click \"Edit\" under actions for the search SentinelOne Devices Lookup - Gen or the name of the cloned search (see Clone Saved Search ). Click \"Edit Schedule\" and update the schedule and necessary.","title":"Update Schedule"},{"location":"configure/schedule/#update-schedule","text":"To update the schedule modify the SentinelOne Devices Lookup - Gen saved search. It is recommended to clone the default search before making changes (see Clone Saved Search ). The default saved search runs on the 29th minute of every hour to update and continually build the SentinelOne assets. Most users will find that this schedule works for their environment. To update the default schedule perform the following steps: Navigate to Settings > Searches, reports, and alerts. Set the \"App\" dropdown to SA-SentinelOneDevices . Set the \"Owner\" dropdown to All . Click \"Edit\" under actions for the search SentinelOne Devices Lookup - Gen or the name of the cloned search (see Clone Saved Search ). Click \"Edit Schedule\" and update the schedule and necessary.","title":"Update Schedule"},{"location":"configure/best-practice/clone-search/","text":"Clone default saved search \u00b6 In order to preserve the default behavior and to compare changes to new releases, it is recommended to clone the default search SentinelOne Devices Lookup - Gen before making any changes. Clone \u00b6 Perform the following to clone the default search: Navigate to Settings > Searches, reports, and alerts. Change \"App\" filter to SA-SentinelOneDevices . Change \"Owner\" to All . For the search named \"SentinelOne Devices Lookup - Gen\" click \"Edit\" under Actions. From the dropdown menu click \"Clone.\" (optional) Update the Title. Set \"Permissions\" to clone . Click \"Clone Report\" to finish. Disable default search \u00b6 Disable the original search: For the search named \"SentinelOne Devices Lookup - Gen\" click \"Edit\" under Actions. From the dropdown menu click \"Disable\" to disable the default search.","title":"Clone Saved Search"},{"location":"configure/best-practice/clone-search/#clone-default-saved-search","text":"In order to preserve the default behavior and to compare changes to new releases, it is recommended to clone the default search SentinelOne Devices Lookup - Gen before making any changes.","title":"Clone default saved search"},{"location":"configure/best-practice/clone-search/#clone","text":"Perform the following to clone the default search: Navigate to Settings > Searches, reports, and alerts. Change \"App\" filter to SA-SentinelOneDevices . Change \"Owner\" to All . For the search named \"SentinelOne Devices Lookup - Gen\" click \"Edit\" under Actions. From the dropdown menu click \"Clone.\" (optional) Update the Title. Set \"Permissions\" to clone . Click \"Clone Report\" to finish.","title":"Clone"},{"location":"configure/best-practice/clone-search/#disable-default-search","text":"Disable the original search: For the search named \"SentinelOne Devices Lookup - Gen\" click \"Edit\" under Actions. From the dropdown menu click \"Disable\" to disable the default search.","title":"Disable default search"},{"location":"quickstart/install/","text":"Install \u00b6 Important This supporting add-on must be installed alongside Splunk Enterprise Security. Ensure the prequisites have been completed before proceeding. Download and install from Splunkbase . For detailed information on where to install Splunk Apps/add-ons, including best practices, can be found at Splunk Docs: About Installing Splunk add-ons Standalone Deployments (with Splunk ES) \u00b6 Install this add-on to the single instance. For more information see Splunk Docs: Install add-on in a single-instance Splunk deployment Distributed Deployments \u00b6 Splunk Instance type Supported Required Comments Enterprise Security Search Head Yes Yes Install this add-on to the Enterprise Security Search Head. Splunk Core Search Head (without ES) No No Do not install on regular search heads. Indexers No No Do not install on Indexers. Heavy Forwarders No No Do not install on Heavy Forwarders. Universal Forwarders No No Do not install on Universal Forwarders. The installation steps for deploying Apps/add-ons in a distributed environment can be found at Splunk Docs: Install an add-on in a distributed Splunk deployment Distributed Deployment Compatibility \u00b6 Distributed deployment feature Supported Comments Search Head Clusters Yes You can install this add-on to an Enterprise Security search head cluster. Indexer Clusters No Do not deploy this add-on to an Indexer cluster. Deployment Server No There is no need to use a deployment server to deploy this add-on. * For more information, see Splunk's documentation on installing Add-ons.","title":"Install"},{"location":"quickstart/install/#install","text":"Important This supporting add-on must be installed alongside Splunk Enterprise Security. Ensure the prequisites have been completed before proceeding. Download and install from Splunkbase . For detailed information on where to install Splunk Apps/add-ons, including best practices, can be found at Splunk Docs: About Installing Splunk add-ons","title":"Install"},{"location":"quickstart/install/#standalone-deployments-with-splunk-es","text":"Install this add-on to the single instance. For more information see Splunk Docs: Install add-on in a single-instance Splunk deployment","title":"Standalone Deployments (with Splunk ES)"},{"location":"quickstart/install/#distributed-deployments","text":"Splunk Instance type Supported Required Comments Enterprise Security Search Head Yes Yes Install this add-on to the Enterprise Security Search Head. Splunk Core Search Head (without ES) No No Do not install on regular search heads. Indexers No No Do not install on Indexers. Heavy Forwarders No No Do not install on Heavy Forwarders. Universal Forwarders No No Do not install on Universal Forwarders. The installation steps for deploying Apps/add-ons in a distributed environment can be found at Splunk Docs: Install an add-on in a distributed Splunk deployment","title":"Distributed Deployments"},{"location":"quickstart/install/#distributed-deployment-compatibility","text":"Distributed deployment feature Supported Comments Search Head Clusters Yes You can install this add-on to an Enterprise Security search head cluster. Indexer Clusters No Do not deploy this add-on to an Indexer cluster. Deployment Server No There is no need to use a deployment server to deploy this add-on. * For more information, see Splunk's documentation on installing Add-ons.","title":"Distributed Deployment Compatibility"},{"location":"quickstart/prerequisites/","text":"Prerequisites \u00b6 Important Complete the prerequisites before installing this add-on. Required App Version Description Splunk Enterprise Security 7.x | 6.x This add-on supports Splunk ES and is not designed to work without it. SentinelOne App For Splunk 5.1.x SentinelOne device data must be brought in prior to installing this add-on. See SentinelOne's documentation for more information.","title":"Prerequisites"},{"location":"quickstart/prerequisites/#prerequisites","text":"Important Complete the prerequisites before installing this add-on. Required App Version Description Splunk Enterprise Security 7.x | 6.x This add-on supports Splunk ES and is not designed to work without it. SentinelOne App For Splunk 5.1.x SentinelOne device data must be brought in prior to installing this add-on. See SentinelOne's documentation for more information.","title":"Prerequisites"},{"location":"quickstart/quickstart/","text":"Quick Start \u00b6 This add-on has a saved search and Asset configuration input enabled by default. Overview \u00b6 Updated default macro . Force initial build . Enable asset correlation . Update category multivalue limit . (optional) Update default saved search schedule . (optional) Disable existing asset sources . Update default macro \u00b6 Danger, Will Robinson Failure to update the macro to the correct setting will cause no devices to be available in Splunk Enterprise Security. Macro Default Description sa_sentinelone_index index=sentinelone Index definition for SentinelOne devices index. Update Macro Procedure \u00b6 Update the index definition to the correct index that contains the sentinelone:channel:agents sourcetype. Perform one of the following: (recommended) Update via Splunk ES General Settings . Update via Macro Definition . ES General Settings \u00b6 option 1 (recommended option) (In Splunk Enterprise Security) Navigate to Configure > General > General Settings. From the \"App\" dropdown select SA-SentinelOneDevices . Update the SA-SentinelOneDevices Index definition and click \"Save.\" Macro Definition \u00b6 option 2 Navigate to Settings > Advanced Search > Search Macros. From the \"App\" dropdown choose SA-SentinelOneDevices . Set the \"Owner\" dropdown to any . Click the macro named sa_sentinelone_index to update the index definition. Force Initial Build \u00b6 The initial build of the SentinelOne assets will not occur until the first scheduled runtime (see Update default saved search schedule ). To force the initial build perform the following: Navigate to Settings > Searches, reports, and alerts. Set the \"App\" dropdown to SA-SentinelOneDevices . Set the \"Owner\" dropdown to All . Click \"Run\" under actions for the search SentinelOne Devices Lookup - Gen . Note The search will run in a new tab over the default time period of 60 minutes. Expand the timeframe to a larger window if the number of hosts in the last 60 minutes does not seem accurate. The default search is configured to run hourly to continually append new devices reported from SentinelOne. Enable asset correlation \u00b6 Confirm asset correlation has been setup in Enterprise Security. Navigate to Enterprise Security > Configure > Data Enrichment > Asset and Identity Management. Switch to the \"Correlation Setup\" tab. Either enable for all sourcetypes (Recommended) or selectively by sourcetype. If you choose to enable select sourcetypes, ensure the stash sourcetype is also selected so Notable events will be enriched with asset information. Save. Update category multivalue limit \u00b6 By default, Splunk Enterprise Security limits the values for the category field to 25. This add-on has around 30 values for the category field, which will shorten to 25 unless the default is updated. To increase the default limit, perform the following: From Enterprise Security, navigate to Configure > Data Enrichment > Asset and Identity Management. On the middle navigation, select \"Asset Fields.\" Click the category field from the table and increase the \"Multivalue Limit\" to 40 . Disable existing asset sources \u00b6 optional It may be possible that you have existing Asset Lookups defined. If SentinelOne is widely deployed in your environment the existing lookups may no longer be needed. Update default saved search schedule \u00b6 optional The default saved search runs on the 29th minute of every hour to update and continually build the SentinelOne assets. To update the default schedule perform the following steps: Navigate to Settings > Searches, reports, and alerts. Set the \"App\" dropdown to SA-SentinelOneDevices . Set the \"Owner\" dropdown to All . Click \"Edit\" under actions for the search SentinelOne Devices Lookup - Gen . Click \"Edit Schedule\" and update the schedule and necessary.","title":"Quickstart"},{"location":"quickstart/quickstart/#quick-start","text":"This add-on has a saved search and Asset configuration input enabled by default.","title":"Quick Start"},{"location":"quickstart/quickstart/#overview","text":"Updated default macro . Force initial build . Enable asset correlation . Update category multivalue limit . (optional) Update default saved search schedule . (optional) Disable existing asset sources .","title":"Overview"},{"location":"quickstart/quickstart/#update-default-macro","text":"Danger, Will Robinson Failure to update the macro to the correct setting will cause no devices to be available in Splunk Enterprise Security. Macro Default Description sa_sentinelone_index index=sentinelone Index definition for SentinelOne devices index.","title":"Update default macro"},{"location":"quickstart/quickstart/#update-macro-procedure","text":"Update the index definition to the correct index that contains the sentinelone:channel:agents sourcetype. Perform one of the following: (recommended) Update via Splunk ES General Settings . Update via Macro Definition .","title":"Update Macro Procedure"},{"location":"quickstart/quickstart/#es-general-settings","text":"option 1 (recommended option) (In Splunk Enterprise Security) Navigate to Configure > General > General Settings. From the \"App\" dropdown select SA-SentinelOneDevices . Update the SA-SentinelOneDevices Index definition and click \"Save.\"","title":"ES General Settings"},{"location":"quickstart/quickstart/#macro-definition","text":"option 2 Navigate to Settings > Advanced Search > Search Macros. From the \"App\" dropdown choose SA-SentinelOneDevices . Set the \"Owner\" dropdown to any . Click the macro named sa_sentinelone_index to update the index definition.","title":"Macro Definition"},{"location":"quickstart/quickstart/#force-initial-build","text":"The initial build of the SentinelOne assets will not occur until the first scheduled runtime (see Update default saved search schedule ). To force the initial build perform the following: Navigate to Settings > Searches, reports, and alerts. Set the \"App\" dropdown to SA-SentinelOneDevices . Set the \"Owner\" dropdown to All . Click \"Run\" under actions for the search SentinelOne Devices Lookup - Gen . Note The search will run in a new tab over the default time period of 60 minutes. Expand the timeframe to a larger window if the number of hosts in the last 60 minutes does not seem accurate. The default search is configured to run hourly to continually append new devices reported from SentinelOne.","title":"Force Initial Build"},{"location":"quickstart/quickstart/#enable-asset-correlation","text":"Confirm asset correlation has been setup in Enterprise Security. Navigate to Enterprise Security > Configure > Data Enrichment > Asset and Identity Management. Switch to the \"Correlation Setup\" tab. Either enable for all sourcetypes (Recommended) or selectively by sourcetype. If you choose to enable select sourcetypes, ensure the stash sourcetype is also selected so Notable events will be enriched with asset information. Save.","title":"Enable asset correlation"},{"location":"quickstart/quickstart/#update-category-multivalue-limit","text":"By default, Splunk Enterprise Security limits the values for the category field to 25. This add-on has around 30 values for the category field, which will shorten to 25 unless the default is updated. To increase the default limit, perform the following: From Enterprise Security, navigate to Configure > Data Enrichment > Asset and Identity Management. On the middle navigation, select \"Asset Fields.\" Click the category field from the table and increase the \"Multivalue Limit\" to 40 .","title":"Update category multivalue limit"},{"location":"quickstart/quickstart/#disable-existing-asset-sources","text":"optional It may be possible that you have existing Asset Lookups defined. If SentinelOne is widely deployed in your environment the existing lookups may no longer be needed.","title":"Disable existing asset sources"},{"location":"quickstart/quickstart/#update-default-saved-search-schedule","text":"optional The default saved search runs on the 29th minute of every hour to update and continually build the SentinelOne assets. To update the default schedule perform the following steps: Navigate to Settings > Searches, reports, and alerts. Set the \"App\" dropdown to SA-SentinelOneDevices . Set the \"Owner\" dropdown to All . Click \"Edit\" under actions for the search SentinelOne Devices Lookup - Gen . Click \"Edit Schedule\" and update the schedule and necessary.","title":"Update default saved search schedule"},{"location":"reference/all-configurations/","text":"All Configurations \u00b6 Below is a table that list all configuration for this add-on. Name Type Web Location CLI Location* Description SentinelOne Devices Lookup - Gen Saved Search Settings > Searches reports, and alerts savedsearches.conf Populates the lookup file sentinelone_devices . SentinelOne Devices Lookup - Cleanup Saved Search Settings > Searches reports, and alerts savedsearches.conf removes old entries from kvstore lookup: sentinelone_devices . sentinelone_devices lookup Settings > Lookups > Lookup definitions transforms.conf Lookup definition for the KVstore collection sentinelone_devices_collection . sentinelone_devices_collection KVStore collection n/a** collections.conf KVstore configuration. sa_sentinelone_index Search macro Settings > Advanced Search > Search Macros macros.conf Index definition for the sentinelone index that contains the sourcetype sentinelone:channel:agents . sa_sentinelone_retention Search macro Settings > Advanced Search > Search Macros macros.conf The amount of time for the device not being updated before it is removed from the lookup. default \"-2d\" identity_manager://sentinelone_devices Asset lookup configuration Enterprise Security > Configure > Data Enrichment > Asset and Identity Management > Asset Lookups inputs.conf Asset configuration lookup to load SentinelOne devices into the asset database. *CLI locations are relative to ../default . Any update to CLI configuration files should be done in the local directory. **If you have the Splunk App for Lookup File Editing , the KVStore collection sentinelone_devices_collection is viewable within the Web interface.","title":"All Configurations"},{"location":"reference/all-configurations/#all-configurations","text":"Below is a table that list all configuration for this add-on. Name Type Web Location CLI Location* Description SentinelOne Devices Lookup - Gen Saved Search Settings > Searches reports, and alerts savedsearches.conf Populates the lookup file sentinelone_devices . SentinelOne Devices Lookup - Cleanup Saved Search Settings > Searches reports, and alerts savedsearches.conf removes old entries from kvstore lookup: sentinelone_devices . sentinelone_devices lookup Settings > Lookups > Lookup definitions transforms.conf Lookup definition for the KVstore collection sentinelone_devices_collection . sentinelone_devices_collection KVStore collection n/a** collections.conf KVstore configuration. sa_sentinelone_index Search macro Settings > Advanced Search > Search Macros macros.conf Index definition for the sentinelone index that contains the sourcetype sentinelone:channel:agents . sa_sentinelone_retention Search macro Settings > Advanced Search > Search Macros macros.conf The amount of time for the device not being updated before it is removed from the lookup. default \"-2d\" identity_manager://sentinelone_devices Asset lookup configuration Enterprise Security > Configure > Data Enrichment > Asset and Identity Management > Asset Lookups inputs.conf Asset configuration lookup to load SentinelOne devices into the asset database. *CLI locations are relative to ../default . Any update to CLI configuration files should be done in the local directory. **If you have the Splunk App for Lookup File Editing , the KVStore collection sentinelone_devices_collection is viewable within the Web interface.","title":"All Configurations"},{"location":"reference/asset-mapping/","text":"Asset Database Mapping \u00b6 The following table describes how this add-on maps to the Asset Database. reference Format an asset or identity in Splunk ES ES Asset lookup field SentinelOne App For Splunk Example value Multivalue allowed ip networkInterfaces{}.inet{} 10.15.23.8 true mac networkInterfaces{}.physical 61 e3:1s:7r:38 true nt_host computerName dev-server01 false dns nt_host + domain dev-server01.example.com true owner accountName demo_team false priority see Configure Priority medium false lat from iplocation of externalIp 40.76073 false long from iplocation of externalIp -111.89096 false city from iplocation of externalIp Salt Lake City false country from iplocation of externalIp United States false bunit groupName + siteName computer,finance true category see Category field reference see Category field reference true pci_domain n/a not mapped n/a is_expected set to true if priority=\"critical\" true false should_timesync n/a not mapped n/a should_update n/a not mapped n/a requires_av n/a not mapped n/a cim_entity_zone n/a not mapped n/a","title":"Asset Database mapping"},{"location":"reference/asset-mapping/#asset-database-mapping","text":"The following table describes how this add-on maps to the Asset Database. reference Format an asset or identity in Splunk ES ES Asset lookup field SentinelOne App For Splunk Example value Multivalue allowed ip networkInterfaces{}.inet{} 10.15.23.8 true mac networkInterfaces{}.physical 61 e3:1s:7r:38 true nt_host computerName dev-server01 false dns nt_host + domain dev-server01.example.com true owner accountName demo_team false priority see Configure Priority medium false lat from iplocation of externalIp 40.76073 false long from iplocation of externalIp -111.89096 false city from iplocation of externalIp Salt Lake City false country from iplocation of externalIp United States false bunit groupName + siteName computer,finance true category see Category field reference see Category field reference true pci_domain n/a not mapped n/a is_expected set to true if priority=\"critical\" true false should_timesync n/a not mapped n/a should_update n/a not mapped n/a requires_av n/a not mapped n/a cim_entity_zone n/a not mapped n/a","title":"Asset Database Mapping"},{"location":"reference/category/","text":"Category \u00b6 Default category field mapping \u00b6 Mapped Field SentinelOne App For Splunk Event Field Example value s1_active_threats activeThreats 4 s1_agent_version agentVersion 22.1.2.217 s1_allow_remote_shell allowRemoteShell false s1_apps_vuln_status appsVulnerabilityStatus up_to_date s1_detect_state detectionState full_mode s1_device_type machineType desktop s1_encrypted_apps encryptedApplications true s1_external_ip externalIp 0.0.0.0 s1_firewall_enabled firewallEnabled true s1_is_active isActive true s1_is_decom isDecommissioned false s1_is_infected infected false s1_is_pending_uninstall isPendingUninstall false s1_is_uninstalled isUninstalled false s1_is_updated isUpToDate true s1_last_active lastActiveDate 09/29/22 06:37:37 mdt s1_last_scan scanFinishedAt 07/06/22 09:45:16 mdt s1_last_updated updatedAt 02/14/22 09:52:05 MST s1_last_user lastLoggedInUserName admin s1_location_enabled locationEnabled true s1_location_type locationType fallback s1_mitigate_mode mitigationMode protect s1_mitigate_mode_suspicious mitigationModeSuspicious detect s1_model_name modelName red hat s1_operational_state operationalState db_corruption s1_os_name osName windows 10 enterprise s1_os_type osType windows s1_ranger_status rangerStatus enabled s1_ranger_version rangerVersion 21.11.0.75 s1_remote_profile_state remoteProfilingState disabled s1_sys_name modelName kvm s1_threat_reboot_required threatRebootRequired false splunk_last_updated now() 09/29/22 18:55:51 mdt Full example of category value \u00b6 gen:sa-sentinelone s1_active_threats: 4 s1_agent_version: 22.1.2.217 s1_allow_remote_shell: false s1_apps_vuln_status: up_to_date s1_detect_state: full_mode s1_device_type: desktop s1_encrypted_apps: false s1_external_ip: 0.0.0.0 s1_firewall_enabled: false s1_is_active: true s1_is_decom: false s1_is_infected: false s1_is_pending_uninstall: false s1_is_uninstalled: false s1_is_updated: true s1_last_active: 09/29/22 06:37:37 mdt s1_last_scan: 07/06/22 09:45:16 mdt s1_last_updated: 09/29/22 06:27:32 mdt s1_last_user: admin s1_location_enabled: true s1_location_type: fallback s1_mitigate_mode: protect s1_mitigate_mode_suspicious: detect s1_model_name: red hat s1_operational_state: db_corruption s1_os_name: windows 10 enterprise s1_os_type: windows s1_ranger_status: enabled s1_ranger_version: 21.11.0.75 s1_reomte_profile_state: disabled s1_sys_name: kvm s1_threat_reboot_required: false splunk_last_updated: 09/29/22 18:55:51 mdt","title":"Category"},{"location":"reference/category/#category","text":"","title":"Category"},{"location":"reference/category/#default-category-field-mapping","text":"Mapped Field SentinelOne App For Splunk Event Field Example value s1_active_threats activeThreats 4 s1_agent_version agentVersion 22.1.2.217 s1_allow_remote_shell allowRemoteShell false s1_apps_vuln_status appsVulnerabilityStatus up_to_date s1_detect_state detectionState full_mode s1_device_type machineType desktop s1_encrypted_apps encryptedApplications true s1_external_ip externalIp 0.0.0.0 s1_firewall_enabled firewallEnabled true s1_is_active isActive true s1_is_decom isDecommissioned false s1_is_infected infected false s1_is_pending_uninstall isPendingUninstall false s1_is_uninstalled isUninstalled false s1_is_updated isUpToDate true s1_last_active lastActiveDate 09/29/22 06:37:37 mdt s1_last_scan scanFinishedAt 07/06/22 09:45:16 mdt s1_last_updated updatedAt 02/14/22 09:52:05 MST s1_last_user lastLoggedInUserName admin s1_location_enabled locationEnabled true s1_location_type locationType fallback s1_mitigate_mode mitigationMode protect s1_mitigate_mode_suspicious mitigationModeSuspicious detect s1_model_name modelName red hat s1_operational_state operationalState db_corruption s1_os_name osName windows 10 enterprise s1_os_type osType windows s1_ranger_status rangerStatus enabled s1_ranger_version rangerVersion 21.11.0.75 s1_remote_profile_state remoteProfilingState disabled s1_sys_name modelName kvm s1_threat_reboot_required threatRebootRequired false splunk_last_updated now() 09/29/22 18:55:51 mdt","title":"Default category field mapping"},{"location":"reference/category/#full-example-of-category-value","text":"gen:sa-sentinelone s1_active_threats: 4 s1_agent_version: 22.1.2.217 s1_allow_remote_shell: false s1_apps_vuln_status: up_to_date s1_detect_state: full_mode s1_device_type: desktop s1_encrypted_apps: false s1_external_ip: 0.0.0.0 s1_firewall_enabled: false s1_is_active: true s1_is_decom: false s1_is_infected: false s1_is_pending_uninstall: false s1_is_uninstalled: false s1_is_updated: true s1_last_active: 09/29/22 06:37:37 mdt s1_last_scan: 07/06/22 09:45:16 mdt s1_last_updated: 09/29/22 06:27:32 mdt s1_last_user: admin s1_location_enabled: true s1_location_type: fallback s1_mitigate_mode: protect s1_mitigate_mode_suspicious: detect s1_model_name: red hat s1_operational_state: db_corruption s1_os_name: windows 10 enterprise s1_os_type: windows s1_ranger_status: enabled s1_ranger_version: 21.11.0.75 s1_reomte_profile_state: disabled s1_sys_name: kvm s1_threat_reboot_required: false splunk_last_updated: 09/29/22 18:55:51 mdt","title":"Full example of category value"},{"location":"reference/example/","text":"Example Output \u00b6 See the following for an example event produced by this add-on.","title":"Example Output"},{"location":"reference/example/#example-output","text":"See the following for an example event produced by this add-on.","title":"Example Output"},{"location":"releases/","text":"Release notes \u00b6 v1.0.1 December 20, 2022 \u00b6 Compatibility \u00b6 Product Version Splunk platform versions 9.x, 8.x Splunk Enterprise Security version 7.x, 6.x SentinelOne App For Splunk 5.1.x What's Changed \u00b6 Added managed configurations for ES - #5 Added managed settings for ES Full Changelog : v1.0.0...v1.0.1 Known issues \u00b6 Issue Description Solution GitHub issue reference Lookup file error You may see the error status=\"Lookup file error, unknown path or update time\" name=sa_aws_assets This error exists since the KVstore is being used opposed to a csv file and does not interfere with the functionality of lookup creation. Issue #4 Issues can be reported on the SA-SentinelOneDevices's GitHub page .","title":"Release Notes"},{"location":"releases/#release-notes","text":"","title":"Release notes"},{"location":"releases/#v101-december-20-2022","text":"","title":"v1.0.1 December 20, 2022"},{"location":"releases/#compatibility","text":"Product Version Splunk platform versions 9.x, 8.x Splunk Enterprise Security version 7.x, 6.x SentinelOne App For Splunk 5.1.x","title":"Compatibility"},{"location":"releases/#whats-changed","text":"Added managed configurations for ES - #5 Added managed settings for ES Full Changelog : v1.0.0...v1.0.1","title":"What's Changed"},{"location":"releases/#known-issues","text":"Issue Description Solution GitHub issue reference Lookup file error You may see the error status=\"Lookup file error, unknown path or update time\" name=sa_aws_assets This error exists since the KVstore is being used opposed to a csv file and does not interfere with the functionality of lookup creation. Issue #4 Issues can be reported on the SA-SentinelOneDevices's GitHub page .","title":"Known issues"},{"location":"releases/release-history/","text":"Release history \u00b6 v1.0.0 September 30, 2022 \u00b6 Compatibility \u00b6 Product Version Splunk platform versions 9.x, 8.x Splunk Enterprise Security version 7.x, 6.x SentinelOne App For Splunk 5.1.x Initial Creation Known issues \u00b6 Issue Description Solution GitHub issue reference Lookup file error You may see the error status=\"Lookup file error, unknown path or update time\" name=sa_aws_assets This error exists since the KVstore is being used opposed to a csv file and does not interfere with the functionality of lookup creation. Issue #4 Issues can be reported on the SA-SentinelOneDevices's GitHub page .","title":"Release History"},{"location":"releases/release-history/#release-history","text":"","title":"Release history"},{"location":"releases/release-history/#v100-september-30-2022","text":"","title":"v1.0.0 September 30, 2022"},{"location":"releases/release-history/#compatibility","text":"Product Version Splunk platform versions 9.x, 8.x Splunk Enterprise Security version 7.x, 6.x SentinelOne App For Splunk 5.1.x Initial Creation","title":"Compatibility"},{"location":"releases/release-history/#known-issues","text":"Issue Description Solution GitHub issue reference Lookup file error You may see the error status=\"Lookup file error, unknown path or update time\" name=sa_aws_assets This error exists since the KVstore is being used opposed to a csv file and does not interfere with the functionality of lookup creation. Issue #4 Issues can be reported on the SA-SentinelOneDevices's GitHub page .","title":"Known issues"},{"location":"troubleshooting/","text":"Troubleshooting \u00b6 There can be many issues when setting up a new app/add-on in Splunk. Below highlights the most common issues with this Add-on. Don't see your issue? Submit a new issue on GitHub . Issue Description Solution Multiple asset merge It is possible that some of your devices share a common mac address or another key field which will cause merging by default. If SentinelOne is your only asset source you can disable asset merge under global settings. See Asset Merge Solution for more information. Asset Database not populating with SentinelOne Data The asset database may show no SentinelOne data if the initial search has not run to build the asset database or the default macro has not been updated. Verify the default macro has the correct index definition (see Update Default Macro ). Also see Force build to build the SentinelOne assets lookup before the first scheduled run. Assets exceeding field limits By default, Splunk Enterprise Security limits the values for the category field to 25. This add-on has around 30 values for the category field, which will shorten to 25 unless the default is updated. How to update multivalue field limit under the Quickstart guide","title":"Troubleshooting"},{"location":"troubleshooting/#troubleshooting","text":"There can be many issues when setting up a new app/add-on in Splunk. Below highlights the most common issues with this Add-on. Don't see your issue? Submit a new issue on GitHub . Issue Description Solution Multiple asset merge It is possible that some of your devices share a common mac address or another key field which will cause merging by default. If SentinelOne is your only asset source you can disable asset merge under global settings. See Asset Merge Solution for more information. Asset Database not populating with SentinelOne Data The asset database may show no SentinelOne data if the initial search has not run to build the asset database or the default macro has not been updated. Verify the default macro has the correct index definition (see Update Default Macro ). Also see Force build to build the SentinelOne assets lookup before the first scheduled run. Assets exceeding field limits By default, Splunk Enterprise Security limits the values for the category field to 25. This add-on has around 30 values for the category field, which will shorten to 25 unless the default is updated. How to update multivalue field limit under the Quickstart guide","title":"Troubleshooting"},{"location":"troubleshooting/solution-guides/asset-merge/","text":"Asset Merge \u00b6 It may be possible that your devices share a common mac address or another key field that is causing an erroneous merge of your assets. If SentinelOne is your only data source for assets, you can disable asset merge in the global settings. In Enterprise Security navigate to Configure > Data Enrichment > Asset and Identity Management > Global Settings. Toggle off \"Assets\" under Enable Merge for Assets or Identities .","title":"Asset Merge"},{"location":"troubleshooting/solution-guides/asset-merge/#asset-merge","text":"It may be possible that your devices share a common mac address or another key field that is causing an erroneous merge of your assets. If SentinelOne is your only data source for assets, you can disable asset merge in the global settings. In Enterprise Security navigate to Configure > Data Enrichment > Asset and Identity Management > Global Settings. Toggle off \"Assets\" under Enable Merge for Assets or Identities .","title":"Asset Merge"}]}